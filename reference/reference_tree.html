<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tree (main class) &#8212; ETE Toolkit 4.0.0-beta documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=039e1c02" />
    <script src="../_static/documentation_options.js?v=f03ed5e5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Phylogenetic trees" href="reference_phylo.html" />
    <link rel="prev" title="Reference Guide" href="index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="tree-main-class">
<h1>Tree (main class)<a class="headerlink" href="#tree-main-class" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="ete4.Tree">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Tree</span></span><a class="headerlink" href="#ete4.Tree" title="Link to this definition">¶</a></dt>
<dd><p>The Tree class is used to store a tree structure.</p>
<p>A tree consists of a collection of Tree instances connected in a
hierarchical way. Trees can be loaded from the New Hampshire
Newick format (newick).</p>
<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – A string or file object with the description of
the tree as a newick, or a dict with the contents of a
single node.</p></li>
<li><p><strong>children</strong> – List of nodes to add as children of this one.</p></li>
<li><p><strong>parser</strong> – A description of how to parse a newick to
create a tree. It can be a single number specifying the
format or a structure with a fine-grained description of
how to interpret nodes (see <code class="docutils literal notranslate"><span class="pre">newick.pyx</span></code>).</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t1</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">()</span>  <span class="c1"># empty tree</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">})</span>
<span class="n">t3</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="s1">&#39;(A:1,(B:1,(C:1,D:1):0.5):0.5);&#39;</span><span class="p">)</span>
<span class="n">t4</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/home/user/my-tree.nw&#39;</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.add_child">
<span class="sig-name descname"><span class="pre">add_child</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">child</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">support</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.add_child" title="Link to this definition">¶</a></dt>
<dd><p>Add a new child to this node and return it.</p>
<p>If child node is not suplied, a new node instance will be created.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>child</strong> – Node to be added as a child.</p></li>
<li><p><strong>name</strong> – Name that will be given to the child.</p></li>
<li><p><strong>dist</strong> – Distance from the node to the child.</p></li>
<li><p><strong>support</strong> – Support value of child partition.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.add_children">
<span class="sig-name descname"><span class="pre">add_children</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">children</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.add_children" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.add_face">
<span class="sig-name descname"><span class="pre">add_face</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">face</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'branch-right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collapsed_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.add_face" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.add_face_smartview">
<span class="sig-name descname"><span class="pre">add_face_smartview</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">face</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'branch-right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collapsed_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.add_face_smartview" title="Link to this definition">¶</a></dt>
<dd><p>Add a fixed face to the node.</p>
<p>This type of faces will be always attached to nodes, independently of
the layout function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>face</strong> – Face to add.</p></li>
<li><p><strong>column</strong> – Column number where the face will go. Starts at 0.</p></li>
<li><p><strong>position</strong> – Position to place the face in the node. Posible
values are: “branch-right”, “branch-top”, “branch-bottom”, “aligned”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.add_face_treeview">
<span class="sig-name descname"><span class="pre">add_face_treeview</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">face</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'branch-right'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.add_face_treeview" title="Link to this definition">¶</a></dt>
<dd><p>Add a fixed face to the node.</p>
<p>This type of faces will be always attached to nodes,
independently of the layout function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>face</strong> – Face to add.</p></li>
<li><p><strong>column</strong> – An integer number starting from 0</p></li>
<li><p><strong>position</strong> – Position to place the face in the node. Posible
values are: “branch-right”, “branch-top”, “branch-bottom”, “float”,
“float-behind”, “aligned”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.add_feature">
<span class="sig-name descname"><span class="pre">add_feature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pr_value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.add_feature" title="Link to this definition">¶</a></dt>
<dd><p>Add or update a node’s feature.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.add_features">
<span class="sig-name descname"><span class="pre">add_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">features</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.add_features" title="Link to this definition">¶</a></dt>
<dd><p>Add or update several features.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.add_prop">
<span class="sig-name descname"><span class="pre">add_prop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.add_prop" title="Link to this definition">¶</a></dt>
<dd><p>Add or update node’s property to the given value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.add_props">
<span class="sig-name descname"><span class="pre">add_props</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">props</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.add_props" title="Link to this definition">¶</a></dt>
<dd><p>Add or update several properties.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.add_sister">
<span class="sig-name descname"><span class="pre">add_sister</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sister</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.add_sister" title="Link to this definition">¶</a></dt>
<dd><p>Add a sister to this node and return it.</p>
<p>If sister node is not supplied, a new Tree instance will be created.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.ancestors">
<span class="sig-name descname"><span class="pre">ancestors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.ancestors" title="Link to this definition">¶</a></dt>
<dd><p>Yield all ancestor nodes of this node (up to the root if given).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.check_monophyly">
<span class="sig-name descname"><span class="pre">check_monophyly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'name'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unrooted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.check_monophyly" title="Link to this definition">¶</a></dt>
<dd><p>Return tuple (is_monophyletic, clade_type, leaves_extra).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> – List of values of the selected nodes.</p></li>
<li><p><strong>prop</strong> – Node property being used to check monophyly (i.e.
‘species’ for species trees, ‘name’ for gene family trees,
or any custom feature present in the tree).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ete4.Tree.children">
<span class="sig-name descname"><span class="pre">children</span></span><a class="headerlink" href="#ete4.Tree.children" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ete4.Tree.collapsed_faces">
<span class="sig-name descname"><span class="pre">collapsed_faces</span></span><a class="headerlink" href="#ete4.Tree.collapsed_faces" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.common_ancestor">
<span class="sig-name descname"><span class="pre">common_ancestor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.common_ancestor" title="Link to this definition">¶</a></dt>
<dd><p>Return the last node common to the lineages of the given nodes.</p>
<p>All the nodes should have self as an ancestor, or an error is raised.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.compare">
<span class="sig-name descname"><span class="pre">compare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_collateral</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_support_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_support_ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_duplications</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_polytomies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unrooted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_treeko_splits_to_be_artifact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_tree_attr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'name'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_tree_attr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'name'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.compare" title="Link to this definition">¶</a></dt>
<dd><p>compare this tree with another using robinson foulds symmetric difference
and number of shared edges. Trees of different sizes and with duplicated
items allowed.</p>
<p>returns: a Python dictionary with results</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.cophenetic_matrix">
<span class="sig-name descname"><span class="pre">cophenetic_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.cophenetic_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Return a cophenetic distance matrix of the tree.</p>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Cophenetic">cophenetic matrix</a> is a matrix
representation of the distance between each node.</p>
<p>If we have a tree like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>       ╭╴A
   ╭╴y╶┤
   │   ╰╴B
╴z╶┤
   │   ╭╴C
   ╰╴x╶┤
       │   ╭╴D
       ╰╴w╶┤
           ╰╴E
</pre></div>
</div>
<p>where w, x, y, z are internal nodes, then:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">=</span> <span class="n">d</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">A</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
<p>and:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">E</span><span class="p">)</span> <span class="o">=</span> <span class="n">d</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">A</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">E</span><span class="p">)</span>
       <span class="o">=</span> <span class="p">(</span><span class="n">d</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">A</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">d</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">E</span><span class="p">))</span>
</pre></div>
</div>
<p>To compute it, we use an idea from
<a class="reference external" href="https://gist.github.com/jhcepas/279f9009f46bf675e3a890c19191158b">https://gist.github.com/jhcepas/279f9009f46bf675e3a890c19191158b</a></p>
<p>First, for each node we find its path to the root. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">-&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>
<span class="n">E</span> <span class="o">-&gt;</span> <span class="n">E</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">z</span>
</pre></div>
</div>
<p>and make these orderless sets. Then we XOR the two sets to
only find the elements that are in one or other sets but not
both. In this case A, E, y, x, w.</p>
<p>The distance between the two nodes is the sum of the distances
from each of those nodes to the parent</p>
<p>One more optimization: since the distances are symmetric, and
distance to itself is zero we user itertools.combinations
rather than itertools.permutations. This cuts our computes
from theta(n^2) 1/2n^2 - n (= O(n^2), which is still not
great, but in reality speeds things up for large trees).</p>
<p>For this tree, we will return the two dimensional array:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>          <span class="n">A</span>                <span class="n">B</span>                <span class="n">C</span>                <span class="n">D</span>                <span class="n">E</span>
<span class="n">A</span>         <span class="mi">0</span>         <span class="n">d</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">B</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>  <span class="n">d</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">z</span><span class="p">)</span>  <span class="n">d</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">D</span><span class="o">-</span><span class="n">z</span><span class="p">)</span>  <span class="n">d</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">E</span><span class="o">-</span><span class="n">z</span><span class="p">)</span>
<span class="n">B</span>  <span class="n">d</span><span class="p">(</span><span class="n">B</span><span class="o">-</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>         <span class="mi">0</span>         <span class="n">d</span><span class="p">(</span><span class="n">B</span><span class="o">-</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">z</span><span class="p">)</span>  <span class="n">d</span><span class="p">(</span><span class="n">B</span><span class="o">-</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">D</span><span class="o">-</span><span class="n">z</span><span class="p">)</span>  <span class="n">d</span><span class="p">(</span><span class="n">B</span><span class="o">-</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">E</span><span class="o">-</span><span class="n">z</span><span class="p">)</span>
<span class="n">C</span>  <span class="n">d</span><span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">z</span><span class="p">)</span>  <span class="n">d</span><span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">B</span><span class="o">-</span><span class="n">z</span><span class="p">)</span>         <span class="mi">0</span>         <span class="n">d</span><span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">D</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>  <span class="n">d</span><span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">E</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="n">D</span>  <span class="n">d</span><span class="p">(</span><span class="n">D</span><span class="o">-</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">z</span><span class="p">)</span>  <span class="n">d</span><span class="p">(</span><span class="n">D</span><span class="o">-</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">B</span><span class="o">-</span><span class="n">z</span><span class="p">)</span>  <span class="n">d</span><span class="p">(</span><span class="n">D</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>         <span class="mi">0</span>         <span class="n">d</span><span class="p">(</span><span class="n">D</span><span class="o">-</span><span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">E</span><span class="o">-</span><span class="n">w</span><span class="p">)</span>
<span class="n">E</span>  <span class="n">d</span><span class="p">(</span><span class="n">E</span><span class="o">-</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">z</span><span class="p">)</span>  <span class="n">d</span><span class="p">(</span><span class="n">E</span><span class="o">-</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">B</span><span class="o">-</span><span class="n">z</span><span class="p">)</span>  <span class="n">d</span><span class="p">(</span><span class="n">E</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>  <span class="n">d</span><span class="p">(</span><span class="n">E</span><span class="o">-</span><span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">D</span><span class="o">-</span><span class="n">w</span><span class="p">)</span>         <span class="mi">0</span>
</pre></div>
</div>
<p>We will also return the one dimensional array with the leaves
in the order in which they appear in the matrix (i.e. the
column and/or row headers).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpickle'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.copy" title="Link to this definition">¶</a></dt>
<dd><p>Return a copy of the current node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>method</strong> – Protocol used to copy the node structure.</p>
</dd>
</dl>
<p>The following values are accepted for the method:</p>
<ul class="simple">
<li><dl class="simple">
<dt>“newick”: Tree topology, node names, branch lengths and</dt><dd><p>branch support values will be copied by as represented in
the newick string (copy by newick string serialisation).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>“newick-extended”: Tree topology and all node properties</dt><dd><p>will be copied based on the extended newick format
representation. Only node properties will be copied, thus
excluding other node attributes. As this method is also
based on newick serialisation, properties will be converted
into text strings when making the copy.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>“cpickle”: The whole node structure and its content is</dt><dd><p>cloned based on cPickle object serialisation (slower, but
recommended for full tree copying)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>“deepcopy”: The whole node structure and its content is</dt><dd><p>copied based on the standard “copy” Python functionality
(this is the slowest method but it allows to copy complex
objects even if attributes point to lambda functions, etc.)</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.del_feature">
<span class="sig-name descname"><span class="pre">del_feature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pr_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.del_feature" title="Link to this definition">¶</a></dt>
<dd><p>Permanently deletes a node’s feature.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.del_prop">
<span class="sig-name descname"><span class="pre">del_prop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prop_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.del_prop" title="Link to this definition">¶</a></dt>
<dd><p>Permanently delete a node’s property.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.delete">
<span class="sig-name descname"><span class="pre">delete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prevent_nondicotomic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preserve_branch_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.delete" title="Link to this definition">¶</a></dt>
<dd><p>Delete node from the tree structure, keeping its children.</p>
<p>The children from the deleted node are transferred to the old parent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prevent_nondicotomic</strong> – If True (default), it will also
delete parent nodes until no single-child nodes occur.</p></li>
<li><p><strong>preserve_branch_length</strong> – If True, branch lengths
of the deleted nodes are transferred (summed up) to the
parent’s branch, thus keeping original distances among
nodes.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="s1">&#39;(C,(B,A)H)root;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">to_str</span><span class="p">(</span><span class="n">props</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
<span class="c1">#       ╭╴C</span>
<span class="c1"># ╴root╶┤</span>
<span class="c1">#       │   ╭╴B</span>
<span class="c1">#       ╰╴H╶┤</span>
<span class="c1">#           ╰╴A</span>

<span class="n">t</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>  <span class="c1"># delete the &quot;H&quot; node</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">to_str</span><span class="p">(</span><span class="n">props</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
<span class="c1">#       ╭╴C</span>
<span class="c1">#       │</span>
<span class="c1"># ╴root╶┼╴B</span>
<span class="c1">#       │</span>
<span class="c1">#       ╰╴A</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.descendants">
<span class="sig-name descname"><span class="pre">descendants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'levelorder'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_leaf_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.descendants" title="Link to this definition">¶</a></dt>
<dd><p>Yield all descendant nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.describe">
<span class="sig-name descname"><span class="pre">describe</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.describe" title="Link to this definition">¶</a></dt>
<dd><p>Return a string with information on this node and its connections.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.detach">
<span class="sig-name descname"><span class="pre">detach</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.detach" title="Link to this definition">¶</a></dt>
<dd><p>Detach this node (and descendants) from its parent and return itself.</p>
<p>The detached node conserves all its structure of descendants,
and can be attached to another node with the <a class="reference internal" href="#ete4.Tree.add_child" title="ete4.Tree.add_child"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_child()</span></code></a>
function. This mechanism can be seen as a “cut and paste”.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ete4.Tree.dist">
<span class="sig-name descname"><span class="pre">dist</span></span><a class="headerlink" href="#ete4.Tree.dist" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.edges">
<span class="sig-name descname"><span class="pre">edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cached_content</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.edges" title="Link to this definition">¶</a></dt>
<dd><p>Yield a pair of sets of leafs for every partition of the tree.</p>
<p>For every node, there are leaves that lay on one side of that
node, and leaves that lay on the other. This generator yields
all those pairs of sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cached_content</strong> – Dictionary that to each node associates the
leaves that descend from it. If passed, it won’t be recomputed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.expand_polytomies">
<span class="sig-name descname"><span class="pre">expand_polytomies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_prop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'name'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polytomy_size_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_large_polytomies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.expand_polytomies" title="Link to this definition">¶</a></dt>
<dd><p>Return all combinations of solutions of the multifurcated nodes.</p>
<p>If the tree has one or more polytomies, this functions returns
the list of all trees (in newick format) resulting from the
combination of all possible solutions of the multifurcated
nodes.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please note that the number of of possible binary trees grows
exponentially with the number and size of polytomies. Using this
function with large multifurcations is not feasible:</p>
<p>polytomy size: 3 number of binary trees: 3
polytomy size: 4 number of binary trees: 15
polytomy size: 5 number of binary trees: 105
polytomy size: 6 number of binary trees: 945
polytomy size: 7 number of binary trees: 10395
polytomy size: 8 number of binary trees: 135135
polytomy size: 9 number of binary trees: 2027025</p>
</div>
<p>See <a class="reference external" href="https://ajmonline.org/2010/darwin.php">https://ajmonline.org/2010/darwin.php</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.explore">
<span class="sig-name descname"><span class="pre">explore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layouts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_leaf_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_branch_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_branch_support</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('name',</span> <span class="pre">'dist')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">host</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'localhost'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_server</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">open_browser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.explore" title="Link to this definition">¶</a></dt>
<dd><p>Launch an interactive smartview session to visualize the tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – Name used to store and refer to the tree.</p></li>
<li><p><strong>layouts</strong> (<em>list</em>) – Layouts that will be available from the
front end. It is important to name functions (__name__), as they
will be adressed by that name in the explorer.</p></li>
<li><p><strong>include_props</strong> (<em>list</em>) – Properties to show in the nodes popup.
If None, show all.</p></li>
<li><p><strong>exclude_props</strong> (<em>list</em>) – Properties to exclude from the nodes popup.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ete4.Tree.faces">
<span class="sig-name descname"><span class="pre">faces</span></span><a class="headerlink" href="#ete4.Tree.faces" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.from_parent_child_table">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_parent_child_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_child_table</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.from_parent_child_table" title="Link to this definition">¶</a></dt>
<dd><p>Convert a parent-child table into an ETE Tree instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parent_child_table</strong> – List of tuples containing
parent-child relationships. For example: [(‘A’, ‘B’, 0.1),
(‘A’, ‘C’, 0.2), (‘C’, ‘D’, 1), (‘C’, ‘E’, 1.5)], where
each tuple represents: [parent, child, child-parent-dist]</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="o">.</span><span class="n">from_parent_child_table</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
                                  <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
                                  <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                                  <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">to_str</span><span class="p">(</span><span class="n">props</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;dist&#39;</span><span class="p">]))</span>
<span class="c1">#      ╭╴B,0.1</span>
<span class="c1"># ╴A,⊗╶┤</span>
<span class="c1">#      │       ╭╴D,1.0</span>
<span class="c1">#      ╰╴C,0.2╶┤</span>
<span class="c1">#              ╰╴E,1.5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.from_skbio">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_skbio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skbio_tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_attributes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.from_skbio" title="Link to this definition">¶</a></dt>
<dd><p>Convert a scikit-bio TreeNode object into ETE Tree object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>skbio_tree</strong> – A scikit bio TreeNode instance</p></li>
<li><p><strong>map_attributes</strong> – List of attribute names in the
scikit-bio tree that should be mapped into the ETE tree
instance. (name, id and branch length are always mapped)</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="o">.</span><span class="n">from_skibio</span><span class="p">(</span><span class="n">skbioTree</span><span class="p">,</span> <span class="n">map_attributes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.get_cached_content">
<span class="sig-name descname"><span class="pre">get_cached_content</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prop=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container_type=&lt;class</span> <span class="pre">'set'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaves_only=True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.get_cached_content" title="Link to this definition">¶</a></dt>
<dd><p>Return dict that assigns to each node a set of its leaves.</p>
<p>The dictionary serves as a cache for operations that require
many traversals of the nodes under this tree.</p>
<p>Instead of assigning a set, it can assign a list (with
<code class="docutils literal notranslate"><span class="pre">container_type</span></code>). And instead of the leaves themselves, it
can be any of their properties (like their names, with <code class="docutils literal notranslate"><span class="pre">prop</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prop</strong> – Node property that should be cached (i.e.
name, distance, etc.). If None, it caches the node itself.</p></li>
<li><p><strong>container_type</strong> – Type of container for the leaves (set, list).</p></li>
<li><p><strong>leaves_only</strong> – If False, for each node it stores all its
descendant nodes, not only its leaves.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.get_children">
<span class="sig-name descname"><span class="pre">get_children</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.get_children" title="Link to this definition">¶</a></dt>
<dd><p>Return an independent list of the node’s children.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.get_closest_leaf">
<span class="sig-name descname"><span class="pre">get_closest_leaf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topological</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_leaf_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.get_closest_leaf" title="Link to this definition">¶</a></dt>
<dd><p>Return the node’s closest descendant leaf, and its distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>topological</strong> – If True, the distance between nodes will be the
number of nodes between them (instead of the sum of branch lenghts).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.get_distance">
<span class="sig-name descname"><span class="pre">get_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topological</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.get_distance" title="Link to this definition">¶</a></dt>
<dd><p>Return the distance between the given nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node1</strong> – A node within the same tree structure.</p></li>
<li><p><strong>node2</strong> – Another node within the same tree structure.</p></li>
<li><p><strong>topological</strong> – If True, distance will refer to the number of
nodes between target and target2.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.get_farthest_leaf">
<span class="sig-name descname"><span class="pre">get_farthest_leaf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topological</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_leaf_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.get_farthest_leaf" title="Link to this definition">¶</a></dt>
<dd><p>Return the node’s farthest descendant (a leaf), and its distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>topological</strong> – If True, the distance between nodes will be the
number of nodes between them (instead of the sum of branch lenghts).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.get_farthest_node">
<span class="sig-name descname"><span class="pre">get_farthest_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topological</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.get_farthest_node" title="Link to this definition">¶</a></dt>
<dd><p>Returns the farthest descendant or ancestor node, and its distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>topological</strong> – If True, the distance between nodes will be the
number of nodes between them (instead of the sum of branch lenghts).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.get_midpoint_outgroup">
<span class="sig-name descname"><span class="pre">get_midpoint_outgroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topological</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.get_midpoint_outgroup" title="Link to this definition">¶</a></dt>
<dd><p>Return the node dividing into two distance-balanced partitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>topological</strong> – If True, the distance between nodes will be the
number of nodes between them (instead of the sum of branch lenghts).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.get_monophyletic">
<span class="sig-name descname"><span class="pre">get_monophyletic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'name'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.get_monophyletic" title="Link to this definition">¶</a></dt>
<dd><p>Yield nodes matching the provided monophyly criteria.</p>
<p>For a node to be considered a match, all <code class="docutils literal notranslate"><span class="pre">prop</span></code> values within
the node, and exclusively them, should be grouped.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> – List of values of the selected nodes.</p></li>
<li><p><strong>prop</strong> – Property being used to check monophyly (for example
‘species’ for species trees, ‘name’ for gene family trees).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.get_prop">
<span class="sig-name descname"><span class="pre">get_prop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.get_prop" title="Link to this definition">¶</a></dt>
<dd><p>Return the node’s property prop (an attribute or in self.props).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.get_sisters">
<span class="sig-name descname"><span class="pre">get_sisters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.get_sisters" title="Link to this definition">¶</a></dt>
<dd><p>Return an independent list of sister nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.get_topology_id">
<span class="sig-name descname"><span class="pre">get_topology_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'name'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.get_topology_id" title="Link to this definition">¶</a></dt>
<dd><p>Return a unique ID representing the topology of the tree.</p>
<p>Two trees with the same topology will produce the same id.
This is useful to detect the number of unique topologies over
a bunch of trees, without requiring full distance methods.</p>
<p>The id is, by default, calculated based on the terminal node’s
names. Any other node property could be used instead.</p>
<p>If trees are unrooted, make sure that the root node is not
binary or use the tree.unroot() function before generating the
topology id.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ete4.Tree.id">
<span class="sig-name descname"><span class="pre">id</span></span><a class="headerlink" href="#ete4.Tree.id" title="Link to this definition">¶</a></dt>
<dd><p>Return node_id (list of relative hops from root to node).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ete4.Tree.img_style">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">img_style</span></span><a class="headerlink" href="#ete4.Tree.img_style" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.init_from_ete">
<span class="sig-name descname"><span class="pre">init_from_ete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.init_from_ete" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.init_from_newick">
<span class="sig-name descname"><span class="pre">init_from_newick</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.init_from_newick" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ete4.Tree.is_collapsed">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_collapsed</span></span><a class="headerlink" href="#ete4.Tree.is_collapsed" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ete4.Tree.is_initialized">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_initialized</span></span><a class="headerlink" href="#ete4.Tree.is_initialized" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ete4.Tree.is_leaf">
<span class="sig-name descname"><span class="pre">is_leaf</span></span><a class="headerlink" href="#ete4.Tree.is_leaf" title="Link to this definition">¶</a></dt>
<dd><p>Return True if the current node is a leaf.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.is_monophyletic">
<span class="sig-name descname"><span class="pre">is_monophyletic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.is_monophyletic" title="Link to this definition">¶</a></dt>
<dd><p>Return True if the nodes form a monophyletic group.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ete4.Tree.is_root">
<span class="sig-name descname"><span class="pre">is_root</span></span><a class="headerlink" href="#ete4.Tree.is_root" title="Link to this definition">¶</a></dt>
<dd><p>Return True if the current node has no parent.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.iter_prepostorder">
<span class="sig-name descname"><span class="pre">iter_prepostorder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_leaf_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.iter_prepostorder" title="Link to this definition">¶</a></dt>
<dd><p>Yield all nodes in a tree in both pre and post order.</p>
<p>Each iteration returns a postorder flag (True if node is being visited
in postorder) and a node instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.ladderize">
<span class="sig-name descname"><span class="pre">ladderize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.ladderize" title="Link to this definition">¶</a></dt>
<dd><p>Sort branches according to the size of each partition.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="s1">&#39;(f,((d,((a,b),c)),e));&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="c1">#   ╭╴f</span>
<span class="c1"># ──┤     ╭╴d</span>
<span class="c1">#   │  ╭──┤  ╭──┬╴a</span>
<span class="c1">#   ╰──┤  ╰──┤  ╰╴b</span>
<span class="c1">#      │     ╰╴c</span>
<span class="c1">#      ╰╴e</span>

<span class="n">t</span><span class="o">.</span><span class="n">ladderize</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="c1"># ──┬╴f</span>
<span class="c1">#   ╰──┬╴e</span>
<span class="c1">#      ╰──┬╴d</span>
<span class="c1">#         ╰──┬╴c</span>
<span class="c1">#            ╰──┬╴a</span>
<span class="c1">#               ╰╴b</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.leaf_names">
<span class="sig-name descname"><span class="pre">leaf_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_leaf_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.leaf_names" title="Link to this definition">¶</a></dt>
<dd><p>Yield the leaf names under this node.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.leaves">
<span class="sig-name descname"><span class="pre">leaves</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_leaf_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.leaves" title="Link to this definition">¶</a></dt>
<dd><p>Yield the terminal nodes (leaves) under this node.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ete4.Tree.level">
<span class="sig-name descname"><span class="pre">level</span></span><a class="headerlink" href="#ete4.Tree.level" title="Link to this definition">¶</a></dt>
<dd><p>Return the number of nodes between this node and the root.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.lineage">
<span class="sig-name descname"><span class="pre">lineage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.lineage" title="Link to this definition">¶</a></dt>
<dd><p>Yield all nodes in the lineage of this node (up to root if given).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ete4.Tree.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#ete4.Tree.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.phonehome">
<span class="sig-name descname"><span class="pre">phonehome</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.phonehome" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.pop_child">
<span class="sig-name descname"><span class="pre">pop_child</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">child_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.pop_child" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.populate">
<span class="sig-name descname"><span class="pre">populate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names_library</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_branches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">support_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.populate" title="Link to this definition">¶</a></dt>
<dd><p>Populate current node with branches generating a random topology.</p>
<p>All the nodes added will either be leaves or have two branches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> – Number of leaves to add. The necessary
intermediate nodes will be created too.</p></li>
<li><p><strong>names_library</strong> – Collection (list or set) used to name leaves.
If None, leaves will be named using short letter sequences.</p></li>
<li><p><strong>random_branches</strong> – If True, branch distances and support
values will be randomized.</p></li>
<li><p><strong>dist_range</strong> – Range (tuple with min and max) of distances
used to generate branch distances if random_branches is True.</p></li>
<li><p><strong>support_range</strong> – Range (tuple with min and max) of distances
used to generate branch supports if random_branches is True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ete4.Tree.props">
<span class="sig-name descname"><span class="pre">props</span></span><a class="headerlink" href="#ete4.Tree.props" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.prune">
<span class="sig-name descname"><span class="pre">prune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preserve_branch_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.prune" title="Link to this definition">¶</a></dt>
<dd><p>Prune the topology conserving only the given nodes.</p>
<p>It will only retain the minimum number of nodes that conserve the
topological relationships among the requested nodes. The root node is
always conserved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nodes</strong> – List of node names or objects that should be kept.</p></li>
<li><p><strong>preserve_branch_length</strong> (<em>bool</em>) – If True, branch lengths
of the deleted nodes are transferred (summed up) to its
parent’s branch, thus keeping original distances among nodes.</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="s1">&#39;(((((A,B)C)D,E)F,G)H,(I,J)K)root;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">to_str</span><span class="p">(</span><span class="n">props</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
<span class="c1">#                       ╭╴A</span>
<span class="c1">#               ╭╴D╶╌╴C╶┤</span>
<span class="c1">#           ╭╴F╶┤       ╰╴B</span>
<span class="c1">#           │   │</span>
<span class="c1">#       ╭╴H╶┤   ╰╴E</span>
<span class="c1">#       │   │</span>
<span class="c1"># ╴root╶┤   ╰╴G</span>
<span class="c1">#       │</span>
<span class="c1">#       │   ╭╴I</span>
<span class="c1">#       ╰╴K╶┤</span>
<span class="c1">#           ╰╴J</span>

<span class="n">t1</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">t1</span><span class="o">.</span><span class="n">prune</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">to_str</span><span class="p">(</span><span class="n">props</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
<span class="c1">#       ╭╴A</span>
<span class="c1"># ╴root╶┤</span>
<span class="c1">#       ╰╴B</span>

<span class="n">t2</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">t2</span><span class="o">.</span><span class="n">prune</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t2</span><span class="o">.</span><span class="n">to_str</span><span class="p">(</span><span class="n">props</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
<span class="c1">#           ╭╴A</span>
<span class="c1"># ╴root╶╌╴C╶┤</span>
<span class="c1">#           ╰╴B</span>

<span class="n">t3</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">t3</span><span class="o">.</span><span class="n">prune</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t3</span><span class="o">.</span><span class="n">to_str</span><span class="p">(</span><span class="n">props</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
<span class="c1">#           ╭╴A</span>
<span class="c1">#       ╭╴C╶┤</span>
<span class="c1"># ╴root╶┤   ╰╴B</span>
<span class="c1">#       │</span>
<span class="c1">#       ╰╴I</span>

<span class="n">t4</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">t4</span><span class="o">.</span><span class="n">prune</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t4</span><span class="o">.</span><span class="n">to_str</span><span class="p">(</span><span class="n">props</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
<span class="c1">#               ╭╴A</span>
<span class="c1"># ╴root╶╌╴H╶╌╴F╶┤</span>
<span class="c1">#               ╰╴B</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.remove_child">
<span class="sig-name descname"><span class="pre">remove_child</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">child</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.remove_child" title="Link to this definition">¶</a></dt>
<dd><p>Remove child from this node and return it.</p>
<p>After calling this function, parent and child nodes still exit,
but are no longer connected.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.remove_children">
<span class="sig-name descname"><span class="pre">remove_children</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.remove_children" title="Link to this definition">¶</a></dt>
<dd><p>Remove all children from this node and return a list with them.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.remove_sister">
<span class="sig-name descname"><span class="pre">remove_sister</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sister</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.remove_sister" title="Link to this definition">¶</a></dt>
<dd><p>Remove a sister node.</p>
<p>It has the same effect as self.up.remove_child(sister).</p>
<p>If a sister node is not supplied, the first sister will be deleted
and returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sister</strong> – A node instance to be removed as a sister.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The node removed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.render">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'px'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">90</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.render" title="Link to this definition">¶</a></dt>
<dd><p>Render the tree as an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> – Name of the output image. Valid extensions
are “svg”, “pdf”, and “png”.</p></li>
<li><p><strong>layout</strong> – Layout function or layout function name to use.</p></li>
<li><p><strong>tree_style</strong> – A <cite>TreeStyle</cite> instance containing the image
properties.</p></li>
<li><p><strong>units</strong> – Units for height (h) or width (w). They can be
“px” for pixels, “mm” for millimeters, “in” for inches.</p></li>
<li><p><strong>h</strong> – Height of the image in <code class="xref py py-attr docutils literal notranslate"><span class="pre">units</span></code>.</p></li>
<li><p><strong>w</strong> – Width of the image in <code class="xref py py-attr docutils literal notranslate"><span class="pre">units</span></code>.</p></li>
<li><p><strong>dpi</strong> – Resolution in dots per inch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.resolve_polytomy">
<span class="sig-name descname"><span class="pre">resolve_polytomy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recursive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defaults</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.resolve_polytomy" title="Link to this definition">¶</a></dt>
<dd><p>Resolve all polytomies under the current node, randomly.</p>
<p>A polytomy is a node that has more than 2 children. This
function resolves them by creating an arbitrary dicotomic
structure among the affected nodes. It randomly modifies the
current tree topology and should only be used for
compatibility reasons (like to later use programs that reject
multifurcated nodes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>recursive</strong> – If True, resolve all polytomies under this
node too. Otherwise, only the current node will be
checked and fixed.</p></li>
<li><p><strong>defaults</strong> – Dictionary of properties to use for new nodes.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.robinson_foulds">
<span class="sig-name descname"><span class="pre">robinson_foulds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop_t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'name'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop_t2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'name'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unrooted_trees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_polytomies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polytomy_size_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_large_polytomies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_by_polytomy_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_support_t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_support_t2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.robinson_foulds" title="Link to this definition">¶</a></dt>
<dd><p>Return the Robinson-Foulds distance to the tree, and related info.</p>
<p>The returned tuple contains the Robinson-Foulds symmetric
distance (rf), but also more information:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">rf</span><span class="p">,</span> <span class="n">rf_max</span><span class="p">,</span> <span class="n">common</span><span class="p">,</span>
 <span class="n">edges_t1</span><span class="p">,</span> <span class="n">edges_t2</span><span class="p">,</span> <span class="n">discarded_edges_t1</span><span class="p">,</span> <span class="n">discarded_edges_t2</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t2</strong> – Target tree (tree to compare to the reference tree).</p></li>
<li><p><strong>prop_t1</strong> – Property to use in the reference tree as the
node name when comparing trees.</p></li>
<li><p><strong>prop_t2</strong> – Property to use in the target tree as the node
name when comparing trees.</p></li>
<li><p><strong>unrooted_trees</strong> – If True, consider trees as unrooted.</p></li>
<li><p><strong>expand_polytomies</strong> – If True, all polytomies in the
reference and target tree will be expanded into all
possible binary trees. Robinson-Foulds distance will be
calculated between all tree combinations and the minimum
value will be returned. See also <code class="xref py py-func docutils literal notranslate"><span class="pre">Tree.expand_polytomy()</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ete4.Tree.root">
<span class="sig-name descname"><span class="pre">root</span></span><a class="headerlink" href="#ete4.Tree.root" title="Link to this definition">¶</a></dt>
<dd><p>Return the absolute root node of the current tree structure.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.search_ancestors">
<span class="sig-name descname"><span class="pre">search_ancestors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">conditions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.search_ancestors" title="Link to this definition">¶</a></dt>
<dd><p>Yield ancestor nodes matching the given conditions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.search_descendants">
<span class="sig-name descname"><span class="pre">search_descendants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">conditions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.search_descendants" title="Link to this definition">¶</a></dt>
<dd><p>Yield descendant nodes matching the given conditions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.search_leaves_by_name">
<span class="sig-name descname"><span class="pre">search_leaves_by_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.search_leaves_by_name" title="Link to this definition">¶</a></dt>
<dd><p>Yield leaf nodes matching the given name.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.search_nodes">
<span class="sig-name descname"><span class="pre">search_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">conditions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.search_nodes" title="Link to this definition">¶</a></dt>
<dd><p>Yield nodes matching the given conditions.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">search_nodes</span><span class="p">(</span><span class="n">dist</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;human&#39;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">prop</span><span class="p">[</span><span class="s1">&#39;support&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.set_outgroup">
<span class="sig-name descname"><span class="pre">set_outgroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outgroup</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.set_outgroup" title="Link to this definition">¶</a></dt>
<dd><p>Sets a descendant node as the outgroup of a tree.  This function
can be used to root a tree or even an internal node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>outgroup</strong> – a node instance within the same tree
structure that will be used as a basal node.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.set_outgroup_v2">
<span class="sig-name descname"><span class="pre">set_outgroup_v2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outgroup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_properties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.set_outgroup_v2" title="Link to this definition">¶</a></dt>
<dd><p>Set the given outgroup node at the root and return it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outgroup</strong> – The node too use as future root.</p></li>
<li><p><strong>branch_properties</strong> – List of branch properties (other than “support”).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.set_style">
<span class="sig-name descname"><span class="pre">set_style</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_style</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.set_style" title="Link to this definition">¶</a></dt>
<dd><p>Set ‘node_style’ as the fixed style for the current node.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ETE'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.show" title="Link to this definition">¶</a></dt>
<dd><p>Start an interactive session to visualize the current node.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ete4.Tree.size">
<span class="sig-name descname"><span class="pre">size</span></span><a class="headerlink" href="#ete4.Tree.size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ete4.Tree.sm_style">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sm_style</span></span><a class="headerlink" href="#ete4.Tree.sm_style" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.sort_descendants">
<span class="sig-name descname"><span class="pre">sort_descendants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'name'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.sort_descendants" title="Link to this definition">¶</a></dt>
<dd><p>Sort branches by node names.</p>
<p>After the tree is sorted, if duplicated names are present,
extra criteria should be added to sort nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.standardize">
<span class="sig-name descname"><span class="pre">standardize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delete_orphan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preserve_branch_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.standardize" title="Link to this definition">¶</a></dt>
<dd><p>Resolve multifurcations and remove single-child nodes.</p>
<p>This function changes the current tree structure to produce a
standardized topology: nodes with only one child are removed
and multifurcations are automatically resolved.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ete4.Tree.support">
<span class="sig-name descname"><span class="pre">support</span></span><a class="headerlink" href="#ete4.Tree.support" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.swap_children">
<span class="sig-name descname"><span class="pre">swap_children</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.swap_children" title="Link to this definition">¶</a></dt>
<dd><p>Swap current children order (reversing it).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.to_str">
<span class="sig-name descname"><span class="pre">to_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show_internal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">px</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">py</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">px0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">waterfall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.to_str" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.to_ultrametric">
<span class="sig-name descname"><span class="pre">to_ultrametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topological</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.to_ultrametric" title="Link to this definition">¶</a></dt>
<dd><p>Convert tree to ultrametric (all leaves equally distant from root).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.traverse">
<span class="sig-name descname"><span class="pre">traverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'levelorder'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_leaf_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.traverse" title="Link to this definition">¶</a></dt>
<dd><p>Traverse the tree structure under this node and yield the nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>strategy</strong> (<em>str</em>) – Set the way in which tree
will be traversed. Possible values are: “preorder” (first
parent and then children) “postorder” (first children and
the parent) and “levelorder” (nodes are visited in order
from root to leaves).</p></li>
<li><p><strong>is_leaf_fn</strong> (<em>function</em>) – Function used to interrogate nodes about if
they are terminal or internal. The function should
receive a node instance as first argument and return True
or False. Use this argument to traverse a tree by
dynamically collapsing internal nodes matching <cite>is_leaf_fn</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.unroot">
<span class="sig-name descname"><span class="pre">unroot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'legacy'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.unroot" title="Link to this definition">¶</a></dt>
<dd><p>Unroot current node.</p>
<p>This function is expected to be used on the absolute tree root
node, but it can be also be applied to any other internal
node. It will convert a split into a multifurcation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mode</strong> – The value can be “legacy” or “keep”. If value is
“keep”, it keeps the distance between the leaves by adding
the distance associated to the deleted edge to the
remaining edge. Otherwise that distance is just dropped.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ete4.Tree.up">
<span class="sig-name descname"><span class="pre">up</span></span><a class="headerlink" href="#ete4.Tree.up" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ete4.Tree.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format_root_node</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_leaf_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ete4.Tree.write" title="Link to this definition">¶</a></dt>
<dd><p>Return or write to file the newick representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outfile</strong> (<em>str</em>) – Name of the output file. If present, it will write
the newick to that file instad of returning it as a string.</p></li>
<li><p><strong>props</strong> (<em>list</em>) – Properties to write for all nodes using the Extended
Newick Format. If None, write all available properties.</p></li>
<li><p><strong>parser</strong> – Parser used to encode the tree in newick format.</p></li>
<li><p><strong>format_root_node</strong> (<em>bool</em>) – If True, write content of the root node
too. For compatibility reasons, this is False by default.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">props</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">,</span> <span class="s1">&#39;sci_name&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">ETE Toolkit</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faqs.html">Frequently Asked Questions (FAQs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">ETE Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Reference Guide</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Tree (main class)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference_phylo.html">Phylogenetic trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference_clustering.html">Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference_seqgroup.html">Multiple Sequence Alignments (SeqGroup)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference_treeview.html">Treeview (qt graphics)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference_ncbi.html">NCBITaxa</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Reference Guide</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Reference Guide</a></li>
      <li>Next: <a href="reference_phylo.html" title="next chapter">Phylogenetic trees</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2008 - 2023, The ETE Toolkit Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/reference/reference_tree.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>